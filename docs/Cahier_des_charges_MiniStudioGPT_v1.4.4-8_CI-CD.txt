CAHIER DES CHARGES â€“ MINISTUDIOGPT v1.4.4-8
IntÃ©gration Continue (CI/CD) â€“ Validation automatique et pipeline GitHub Actions
Date : 1er novembre 2025
Auteur : Code GPT + Rachid Hammami
Version : v1.4.4-8 (CI/CD Foundation)

--------------------------------------
ğŸ¯ OBJECTIF GLOBAL
Mettre en place une chaÃ®ne dâ€™intÃ©gration continue (CI/CD) complÃ¨te pour MiniStudioGPT.
Cette Ã©tape intervient AVANT le Cortex Layer (v1.5) et constitue le socle de test et de dÃ©ploiement automatique du projet.

Le pipeline doit :
1. ExÃ©cuter automatiquement les tests unitaires Ã  chaque push sur GitHub.
2. GÃ©nÃ©rer un rapport JSON stockÃ© dans /memory et /reports.
3. Valider la stabilitÃ© du backend avant toute Ã©volution (Cortex Layer inclus).
4. CrÃ©er les fondations du dÃ©ploiement futur automatisÃ© (Docker / Cloudflare).

--------------------------------------
âš™ï¸ PARTIE 1 â€“ ARCHITECTURE CI/CD

Fichier principal : .github/workflows/test_and_deploy.yml

Structure du projet CI/CD :
MiniStudio/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ test_and_deploy.yml
â”œâ”€â”€ reports/
â”‚   â””â”€â”€ report.json
â”œâ”€â”€ memory/
â”‚   â”œâ”€â”€ ci_report_YYYYMMDD-HHMMSS.json
â”‚   â””â”€â”€ session.log
â””â”€â”€ builder_core.py (update_ci_status intÃ©grÃ©)

--------------------------------------
âš™ï¸ PARTIE 2 â€“ WORKFLOW GITHUB ACTIONS

Nom du workflow : ğŸ§ª MiniStudio CI/CD

DÃ©clencheurs :
- push sur main ou develop
- pull_request sur main

TÃ¢ches :
1. Checkout du dÃ©pÃ´t
2. Installation Python 3.11
3. Installation des dÃ©pendances
4. ExÃ©cution des tests avec pytest
5. GÃ©nÃ©ration du rapport JSON (reports/report.json)
6. Copie automatique dans memory/ci_report_*
7. Archivage de lâ€™artefact sur GitHub Actions

--------------------------------------
âš™ï¸ PARTIE 3 â€“ INTÃ‰GRATION AU BUILDER

Fonction Ã  ajouter dans builder_core.py :

def update_ci_status(result: str, report_path="reports/report.json"):
    from datetime import datetime
    import os, shutil, json
    memory_dir = "memory"
    os.makedirs(memory_dir, exist_ok=True)
    dest = os.path.join(memory_dir, f"ci_report_{datetime.now().strftime('%Y%m%d-%H%M%S')}.json")
    shutil.copy(report_path, dest)
    with open(os.path.join(memory_dir, "session.log"), "a", encoding="utf-8") as log:
        log.write(f"[CI/CD] Test run {datetime.now().isoformat()} -> {result}\n")

--------------------------------------
âš™ï¸ PARTIE 4 â€“ TESTS VALIDÃ‰S AUTOMATIQUEMENT

Tests exÃ©cutÃ©s :
- test_apply_code.py
- test_apply_code_async.py
- test_app.py
- test_collab_flow.py

RÃ©sultats attendus :
- 100 % de rÃ©ussite
- Fichiers de logs gÃ©nÃ©rÃ©s dans memory/
- Aucun crash rÃ©seau / permission / syntaxe

--------------------------------------
âš™ï¸ PARTIE 5 â€“ SÃ‰CURITÃ‰ ET SECRETS GITHUB

Variables Ã  dÃ©finir dans GitHub > Settings > Secrets > Actions :
- MINISTUDIO_KEY : clÃ© dâ€™accÃ¨s au backend sÃ©curisÃ©
- CF_TUNNEL_TOKEN : (optionnel) pour test du tunnel Cloudflare

Le workflow ne doit pas exposer ces variables dans les logs.

--------------------------------------
âš™ï¸ PARTIE 6 â€“ RAPPORTS ET HISTORIQUE

Chaque exÃ©cution CI crÃ©e :
- Un rapport JSON dans /reports
- Une copie dans /memory (avec horodatage)
- Une entrÃ©e de log dans session.log
- Un artefact tÃ©lÃ©chargeable via lâ€™onglet Actions de GitHub

Exemple de log :
[CI/CD] Test run 2025-11-01T18:42:30 -> SUCCESS

--------------------------------------
âš™ï¸ PARTIE 7 â€“ VALIDATION

CritÃ¨res de validation :
1. Tests locaux : pytest 100 %
2. Actions GitHub : workflow complÃ©tÃ© sans erreur
3. Rapport CI stockÃ© dans memory/
4. Logs conformes Ã  la norme [CI/CD]
5. Compatible Python 3.11 / Ubuntu-latest

--------------------------------------
âš™ï¸ PARTIE 8 â€“ TRANSITION VERS v1.5 (CORTEX LAYER)

Une fois le CI/CD opÃ©rationnel :
- Les tests du Cortex Layer (mÃ©moire vectorielle, requÃªtes /memory/query) seront intÃ©grÃ©s au mÃªme pipeline.
- Les versions futures (v1.5.x) hÃ©riteront de ce workflow sans duplication.
- Les rapports CI permettront de mesurer la stabilitÃ© du Cortex Ã  chaque Ã©volution.

--------------------------------------
âœ… CONCLUSION

Cette version v1.4.4-8 Ã©tablit le socle de confiance du projet MiniStudioGPT.
Le CI/CD garantit la qualitÃ© continue, la traÃ§abilitÃ© et la sÃ©curitÃ© avant lâ€™intÃ©gration du Cortex Layer.
MiniStudio devient ainsi une plateforme prÃªte pour la collaboration multi-agents IA et le dÃ©ploiement automatisÃ©.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ§  MESSAGE STANDARD POUR LE GPT
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Mission : CrÃ©ation du fichier .github/workflows/test_and_deploy.yml
Cible : GPT personnel (MiniStudioGPT)
Mode : Lecture seule, gÃ©nÃ©ration de code YAML uniquement

Message :
Â« RÃ©dige le contenu complet du fichier .github/workflows/test_and_deploy.yml
en suivant le prÃ©sent cahier des charges MiniStudioGPT v1.4.4-8 CI/CD.
Fournis uniquement le code YAML final, sans explications ni commentaire hors code. Â»
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
